3가지 방법으로 HTTPS 프로토콜 상에서 통신되는 데이터를 보호한다

인증 : 통신하는 서버가 안전한 서버인지 확인할 수 있는지 알려준다. CA(Certification Authority)에서 발급받는 인증서로 상대 서버에 대한 여러 정보를 받을 수 있다

암호화 : HTTP 연결을 수립하여 비대칭 키를 사용하여 대칭 키를 공유하고, 이후 통신 과정에서 대칭 키를 이용하여 데이터를 암호화 및 복호화한다

무결성 : 통신 과정에서 데이터가 변조되거나 손실되는 것을 방지한다

## TLS HandShake 

TLS를 사용하기 위해서는 서버에 인증서가 설치되어 있어야 한다

인증 기관이 도메인을 소유한 사람이나 기업에게 TLS 인증서를 발행한다.
인증서는 서버의 공개키와 도메인 소유자에 대한 정보를 담고 있다

### TLS 핸드쉐이크 과정 
1. Client Hello : 클라이언트가 Hello 메시지를 전송하며 핸드셰이크를 시작한다. TLS 버전, 지원되는 암호 제품군, 클라이언트 무작위라 하는 무작위 바이트 문자열을 포함한다.
2. Server Hello : Client Hello에 대한 응답으로, SSL 인증서, 서버가 선택한 암호 제품군, 서버 무작위라 하는 무작위 바이트 문자열을 포함한다.
3. 클라이언트가 서버의 SSL 인증서를 인증 기관을 통해 검증한다.
4. 클라이언트가 예비 마스터 암호 라고 칭하는 무작위 바이트 문자열을 전송한다. 이때 예비 마스터 암호는 공개 키로 암호화되어 있으며, 서버의 개인 키로만 복호화 할 수 있다.
5. 서버가 예비 마스터 암호를 해독한다.
6. 클라이언트와 서버 모두 클라이언트 무작위, 서버 무작위, 예비 마스터 암호를 통해 세션 키를 생성한다
7. 클라이언트가 세션키로 암호화된 완료 메시지를 전송한다
8. 서버가 세션키로 암호화된 완료 메시지를 전송한다
9. 핸드셰이크가 완료되고 세션키로 통신을 진행한다.

### TLS 인증서 생성 방법
1. **개인 키 생성**
```openssl genrsa -aes256 -out [생성할 개인 키 이름].pem [파일의 비트 수]```
위의 명령을 입력한 후, 생성하는 키 파일의 내용을 보호하기 위한 암호 키를 입력해야 한다

```-aes256```
부분에서 암호화 알고리즘을 선택할 수 있으며, 예시로는 ```-aes128, -aes192, -aes256, -aria128, -aria192, -aria256, -camellia128, -camellia192, -camellia256, -des, -des3, -idea```등이 있다.

2. **공개 키 생성 및 CSR 파일 생성(자체 서명 인증서)**
인증서 서명 요청을 위한 CSR(Certificate Signing Request) 파일을 생성할 때 공개 키가 자동으로 생성된다.
```openssl req -new -key [생성한 개인 키] -out [생성할 파일명].csr```
위의 명령을 입력한 후 이전에 생성한 개인 키의 비밀번호를 입력한다.

그 후 서명을 요청하는 기관의 정보의 값들을 입력한다. 이 인증서를 상위 인증 기관으로 전송하여 전자서명을 받으면 입력한 정보의 값들을 변경할 수 없다.

3. **CSR 파일에 전자서명하기 & 인증서 만들기**
```openssl x509 -in [생성한 CSR 파일] -out [생성할 인증서 파일 이름].crt -req -signkey [생성한 개인 키] -days 365```

- x509 : 공개 키 인증서에 대한 국제 표준 규약
- -days 365 : 인증서의 만료 기간을 설정함 해당 명령어는 1년을 표기

4. **인증서와 개인 키 검증**
```openssl x509 -noout -text -in ./netty.crt```
```openssl rsa -noout -text -in privatekey.pem```

5. 개인키 형식 변환